@model IEnumerable<MSRequestPrj.Models.MSRequests>

<h1>Controle de Requisições</h1>
<br>
<button type="button" class="btn btn-success" data-toggle="modal" data-target="#ModalRequest">
    Novo
</button>

<table id="tableLista" class="table table-striped table-hover">
    <thead class="thead-dark">
        <tr>
            <th class="col">#</th>
            <th class="col">Descrição / Data </th>
            <th class="col">Origem </th>
            <th class="col"> Destino</th>
            <th class="col">URL Destino</th>
            <th class="col">Ativado</th>
            <th class="col">Opções</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <th scope="row">@item.Id</th>
                <td class="col-md-2" id=@String.Format("descricao{0}",item.Id) name="descricao">
                    Descrição: @item.Description <br>
                    Data: @item.DateRequest.ToString("dd/MM/yyyy")
                </td>
                <td>@item.OriginNotifiers.Name</td>
                <td>@item.OriginNotifiers.Name</td>
                <td>@item.DestinyURL</td>
                @{if (item.Actived)
                    {
                        <td>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="flexSwitchCheckDisabled" checked>
                            </div>
                        </td>
                    }
                    else
                    {
                        <td>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="flexSwitchCheckDisabled">
                            </div>
                        </td>
                    }
                }
                <td>
                    @* <a href="#ModalRequest" data-toggle="modal" data-target="#ModalRequest"><button class="btn btn-warning">  Editar</button></a>    *@
                    <button class="editRequest btn btn-warning btn-xs" data-toggle="modal" data-target="#ModalRequest" id="editRequest" name="editRequest">Editar</button>
                    <a href="/Home/Index"><button class="btn btn-danger">  Excluir</button></a>


                </td>

            </tr>

        }
    </tbody>
</table>

<!-- Modal -->
<div class="modal fade" id="ModalRequest" tabindex="-1" role="dialog" aria-labelledby="TituloModalCentralizado" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="TituloModalCentralizado">Nova Requisição</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Fechar">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form action="/MSRequests/Create" method="post">
                    <div class="form-group">
                        <label for="Descrição">Descrição</label>
                        @* <input type="text" class="form-control" id="createdescricao" aria-describedby="Descrição" placeholder="Detalhe o objetvo da requisição"> *@
                        <textarea class="form-control" id="descricao" name="descricao" rows="2" maxlength="100"></textarea>

                    </div>
                    <div class="form-group">
                        <label for="Origem">Origem</label>
                        <select name="origem" id="origem" class="form-select">
                            @foreach (var item in ViewBag.ListaOrigemDestino)
                            {
                                <option value=@item.Id>@item.Name</option>
                            }
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="Destino">Destino</label>
                        <select name="destino" id="destino" class="form-select">
                            @foreach (var item in ViewBag.ListaOrigemDestino)
                            {
                                <option value=@item.Id>@item.Name</option>
                            }
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="urldestino">URL Destino</label>
                        <textarea class="form-control" id="urldestino" name="urldestino" rows="4" maxlength="1000"></textarea>

                    </div>
                    <div class="form-group">
                        <label for="token">Token</label>
                        <input type="text" class="form-control" id="token" name="token" aria-describedby="token" placeholder="crie a chave token">


                    </div>
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="ativado" name="ativado" checked>
                        <label class="form-check-label" for="ativado">Ativado</label>
                    </div>
                    <div class="modal-footer">
                        @* <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button> *@
                        <button type="submit" class="btn btn-primary">Salvar</button>
                    </div>
                </form>
            </div>


        </div>
    </div>
</div>

<script>

 var descricaolinha;
 var origemlinha;
 var destinolinha;
 var  urldestinolinha;
 var ativadolinha;

$(document).ready(function(){

    // code to read selected table row cell data (values).
    $("#tableLista").on('click','.editRequest',function(){
         // get the current row
         var currentRow=$(this).closest("tr");

         descricaolinha=currentRow.find("td:eq(0)").text(); // description
         origemlinha=currentRow.find("td:eq(1)").text(); // origem
         destinolinha=currentRow.find("td:eq(2)").text(); // destino
         urldestinolinha=currentRow.find("td:eq(3)").text(); //url destiny
        ativadolinha=currentRow.find("td:eq(4)").text(); //url destiny

    });



});

$('#ModalRequest').on('show.bs.modal', e => {
          var $button = $(e.relatedTarget);
          $('#descricao').val(descricaolinha);
          $('#origem').val(origemlinha);
          $('#destino').val(destinolinha);
          $('#urldestino').val(urldestinolinha);


});



</script>
